# 💰 하루한포 AI 원가 분석 및 플랜 책정

## 📊 현재 사용 중인 AI 모델

### 1. **GPT-4o** (OpenAI)
- **용도**: 키워드 추천, 일부 고급 분석
- **가격**: 
  - Input: $2.50 / 1M tokens
  - Output: $10.00 / 1M tokens

### 2. **Gemini 2.5 Flash** (Google)
- **용도**: 이미지 분석, 콘텐츠 생성 (메인)
- **가격**:
  - Input: $0.075 / 1M tokens (128K 이하)
  - Output: $0.30 / 1M tokens
  - Input: $0.15 / 1M tokens (128K 초과)
  - Output: $0.60 / 1M tokens

---

## 🔍 1회 콘텐츠 생성 시나리오 분석

### 시나리오: 사용자가 5개 플랫폼 콘텐츠 생성

**입력:**
- 이미지 3장 업로드
- 키워드 5개
- 브랜드명, 업종, 타겟 등 메타데이터

**생성 플랫폼:**
1. 네이버 블로그
2. 인스타그램 피드
3. 스레드
4. 틱톡
5. 유튜브 쇼츠

---

## 💵 단계별 원가 계산

### Step 1: 이미지 분석 (Gemini 2.5 Flash)

**프로세스:**
- 이미지 3장을 Gemini로 분석
- 각 이미지당 분석 프롬프트 + 이미지 토큰

**토큰 추정:**
- 이미지 1장: 약 1,000 tokens (압축된 이미지 표현)
- 분석 프롬프트: 약 200 tokens
- 응답 (이미지 설명): 약 300 tokens

**계산 (이미지 3장):**
```
Input: (1,000 tokens × 3 이미지) + (200 tokens × 3 프롬프트) = 3,600 tokens
Output: 300 tokens × 3 = 900 tokens

비용:
- Input: (3,600 / 1,000,000) × $0.075 = $0.00027
- Output: (900 / 1,000,000) × $0.30 = $0.00027
- 합계: $0.00054 ≈ ₩0.72 (환율 1,330원 기준)
```

**이미지 분석 비용: 약 ₩0.72**

---

### Step 2: 콘텐츠 생성 (Gemini 2.5 Flash × 5 플랫폼)

**프로세스:**
- 각 플랫폼별 맞춤 프롬프트 생성
- Gemini로 콘텐츠 생성

**토큰 추정 (플랫폼당):**
- 프롬프트 (이미지 설명 + 키워드 + 지시사항): 약 1,500 tokens
- 생성된 콘텐츠 (블로그/릴스/쇼츠 등): 약 1,000 tokens

**계산 (5개 플랫폼):**
```
Input: 1,500 tokens × 5 = 7,500 tokens
Output: 1,000 tokens × 5 = 5,000 tokens

비용:
- Input: (7,500 / 1,000,000) × $0.075 = $0.0005625
- Output: (5,000 / 1,000,000) × $0.30 = $0.0015
- 합계: $0.0020625 ≈ ₩2.74
```

**콘텐츠 생성 비용: 약 ₩2.74**

---

### Step 3: 키워드 추천 (GPT-4o) - 선택사항

**프로세스:**
- 이미지 3장을 GPT-4o로 분석
- 키워드 10개 추천

**토큰 추정:**
- 이미지 3장: 약 3,000 tokens
- 프롬프트: 약 300 tokens
- 응답 (키워드 10개): 약 100 tokens

**계산:**
```
Input: 3,300 tokens
Output: 100 tokens

비용:
- Input: (3,300 / 1,000,000) × $2.50 = $0.00825
- Output: (100 / 1,000,000) × $10.00 = $0.001
- 합계: $0.00925 ≈ ₩12.30
```

**키워드 추천 비용: 약 ₩12.30**

---

## 📊 1회 생성당 총 원가

### Case 1: 키워드 수동 입력 (GPT-4o 미사용)
```
이미지 분석: ₩0.72
콘텐츠 생성: ₩2.74
────────────────────
총 원가: ₩3.46
```

### Case 2: 키워드 자동 추천 (GPT-4o 사용)
```
이미지 분석: ₩0.72
키워드 추천: ₩12.30
콘텐츠 생성: ₩2.74
────────────────────
총 원가: ₩15.76
```

---

## 🎯 보수적 원가 추정

**실제 운영 시 추가 요소:**
- 에러 재시도 (10% 추가)
- API 호출 오버헤드
- 네트워크 비용
- 이미지 저장 비용 (Cloudflare R2)

**보정 계수: 1.3x**

### 최종 추정 원가

| 케이스 | 기본 원가 | 보정 원가 (1.3x) | 안전 마진 (2x) |
|--------|----------|------------------|----------------|
| **키워드 수동** | ₩3.46 | **₩4.50** | ₩6.92 |
| **키워드 자동** | ₩15.76 | **₩20.49** | ₩31.52 |

---

## 💡 플랜별 수지 분석

### 현재 플랜 (안)

| 플랜 | 월 비용 | 월 생성 횟수 | 1회당 단가 | 원가 (키워드 수동) | 수지 |
|------|---------|-------------|-----------|-------------------|------|
| **Free** | ₩0 | 10회 | ₩0 | ₩45 | **-₩45** ❌ |
| **Pro** | ₩9,900 | 100회 | ₩99 | ₩450 | **+₩9,450** ✅ |
| **Enterprise** | ₩49,900 | 무제한 | - | - | **위험** ⚠️ |

### 문제점
1. **Free 플랜**: 10회 × ₩4.50 = ₩45 손실
2. **Pro 플랜**: 수익성 양호 (마진 약 95%)
3. **Enterprise 무제한**: 리스크 과다

---

## ✅ 개선된 플랜 (권장)

### Option A: 보수적 (안전성 우선)

| 플랜 | 월 비용 | 월 생성 횟수 | 1회당 단가 | 원가 | 마진 |
|------|---------|-------------|-----------|------|------|
| **Free** | ₩0 | **5회** | ₩0 | ₩22.50 | -₩22.50 (홍보비) |
| **Pro** | ₩9,900 | **50회** | ₩198 | ₩225 | +₩9,675 (97%) |
| **Enterprise** | ₩49,900 | **300회** | ₩166 | ₩1,350 | +₩48,550 (97%) |

**특징:**
- Free: 5회로 축소 (손실 ₩22.50, 홍보비로 감내 가능)
- Pro: 50회로 조정 (충분한 마진 확보)
- Enterprise: 무제한 대신 **300회 한도** (초과 시 별도 협의)

---

### Option B: 적극적 (성장 우선)

| 플랜 | 월 비용 | 월 생성 횟수 | 1회당 단가 | 원가 | 마진 |
|------|---------|-------------|-----------|------|------|
| **Free** | ₩0 | **10회** | ₩0 | ₩45 | -₩45 (홍보비) |
| **Pro** | ₩14,900 | **100회** | ₩149 | ₩450 | +₩14,450 (97%) |
| **Enterprise** | ₩49,900 | **500회** | ₩99 | ₩2,250 | +₩47,650 (95%) |

**특징:**
- Free: 10회 유지 (사용자 유입 우선)
- Pro: 가격 인상 (₩14,900)
- Enterprise: 500회 한도

---

### Option C: 크레딧 하이브리드 (유연성 우선)

| 플랜 | 월 비용 | 기본 제공 | 추가 구매 |
|------|---------|----------|----------|
| **Free** | ₩0 | 5회 | - |
| **Pro** | ₩9,900 | 50회 | 1회 = ₩150 |
| **Enterprise** | ₩49,900 | 300회 | 1회 = ₩100 |

**추가 크레딧 패키지:**
- 10회: ₩1,200 (1회당 ₩120)
- 50회: ₩5,500 (1회당 ₩110)
- 100회: ₩9,900 (1회당 ₩99)

---

## 🎯 최종 권장안

### **Option A (보수적)** ✅ 추천

```markdown
✅ Free: 월 5회
✅ Pro: 월 50회 (₩9,900)
✅ Enterprise: 월 300회 (₩49,900)
```

**선택 이유:**
1. **안전한 원가 구조**: 모든 플랜에서 95%+ 마진 확보
2. **Free 플랜 손실 최소화**: ₩22.50 (홍보비로 감내 가능)
3. **명확한 가치 제안**: 
   - Free → Pro: 10배 증가 (5→50)
   - Pro → Enterprise: 6배 증가 (50→300)
4. **무제한 리스크 제거**: Enterprise도 명확한 한도 설정

---

## 📋 GPT-4o 키워드 추천 정책

### 문제
- GPT-4o 사용 시 원가 ₩20.49 (비싸다!)
- 사용자가 매번 키워드 추천 사용 시 수지 악화

### 해결책

#### 1. 키워드 추천 기능 제한
```typescript
// 플랜별 월간 키워드 추천 제한
const KEYWORD_SUGGESTION_LIMITS = {
  free: 0,        // Free: 수동 입력만 가능
  pro: 10,        // Pro: 월 10회
  enterprise: 50  // Enterprise: 월 50회
};
```

#### 2. 또는 Gemini로 대체
```typescript
// GPT-4o 대신 Gemini 2.5 Flash 사용
// 원가: ₩12.30 → ₩2.74 (약 78% 절감)

async function suggestKeywordsWithGemini(images: string[], brand: string) {
  // Gemini로 키워드 추천 (GPT-4o 대신)
  const result = await generateContentWithGemini(apiKey, `
    이미지를 분석하여 SEO 최적화된 키워드 10개를 추천하세요.
    브랜드: ${brand}
    JSON 배열로 응답: ["키워드1", "키워드2", ...]
  `);
  return JSON.parse(result);
}
```

**권장**: Gemini로 대체 (원가 절감 + 성능 유사)

---

## 🔢 최종 수정된 원가 (Gemini 키워드 추천)

### 1회 생성당 원가
```
이미지 분석 (Gemini): ₩0.72
키워드 추천 (Gemini): ₩2.74
콘텐츠 생성 (Gemini): ₩2.74
────────────────────────────
총 원가: ₩6.20
보정 원가 (1.3x): ₩8.06
```

### 수정된 플랜 수지 분석 (Option A)

| 플랜 | 월 비용 | 월 생성 | 1회 원가 | 총 원가 | 수익 | 마진 |
|------|---------|---------|---------|---------|------|------|
| **Free** | ₩0 | 5회 | ₩8.06 | ₩40.30 | -₩40.30 | - |
| **Pro** | ₩9,900 | 50회 | ₩8.06 | ₩403 | **+₩9,497** | **96%** |
| **Enterprise** | ₩49,900 | 300회 | ₩8.06 | ₩2,418 | **+₩47,482** | **95%** |

---

## 🎉 최종 결론

### 권장 플랜: Option A (보수적)

```markdown
✅ Free: 월 5회 무료 (손실 ₩40, 홍보비)
✅ Pro: 월 50회 ₩9,900 (마진 96%)
✅ Enterprise: 월 300회 ₩49,900 (마진 95%)
```

### 핵심 개선사항
1. **GPT-4o → Gemini 전환**: 키워드 추천 원가 78% 절감
2. **Free 플랜 축소**: 10회 → 5회 (손실 최소화)
3. **Enterprise 한도 설정**: 무제한 → 300회 (리스크 제거)
4. **Pro 플랜 가격**: ₩9,900 유지 (경쟁력 확보)

### 추가 고려사항
- **이미지 개수 제한**: Free는 이미지 1장, Pro는 3장, Enterprise는 5장
- **플랫폼 수 제한**: Free는 3개, Pro는 5개, Enterprise는 10개
- **동시 생성 제한**: Free는 1개씩, Pro는 3개, Enterprise는 5개

---

## 📊 시뮬레이션: 월간 사용자 100명 기준

### 시나리오
- Free: 60명 × 5회 = 300회
- Pro: 30명 × 50회 = 1,500회
- Enterprise: 10명 × 300회 = 3,000회

### 수익 계산
```
수익:
- Free: ₩0
- Pro: ₩9,900 × 30 = ₩297,000
- Enterprise: ₩49,900 × 10 = ₩499,000
────────────────────────────
총 수익: ₩796,000

원가:
- Free: ₩8.06 × 300 = ₩2,418
- Pro: ₩8.06 × 1,500 = ₩12,090
- Enterprise: ₩8.06 × 3,000 = ₩24,180
────────────────────────────
총 원가: ₩38,688

순이익: ₩757,312
마진: 95%
```

**결론**: 매우 건강한 수익 구조! ✅

---

## 🚨 주의사항

### 1. 모델 가격 변동
- OpenAI/Google의 가격 정책 변경 가능
- 정기적인 원가 재계산 필요 (분기별)

### 2. 사용 패턴 모니터링
- 실제 토큰 사용량 추적
- 플랫폼별 평균 생성 시간 측정
- 에러율 및 재시도 비율 확인

### 3. 서버 비용
- Cloudflare Workers: 무료 (월 100,000 요청)
- Cloudflare R2: 스토리지 비용 별도
- Supabase: 무료 또는 Pro ($25/월)

---

## 🎯 실행 계획

1. **즉시**: GPT-4o → Gemini 키워드 추천으로 전환
2. **이번 주**: Option A 플랜으로 단순화 구현
3. **2주 후**: 실제 사용 데이터 수집 및 분석
4. **1개월 후**: 원가/수익 검증 후 플랜 조정

---

**계산 완료! 이제 안심하고 Option A로 진행하세요!** ✅
